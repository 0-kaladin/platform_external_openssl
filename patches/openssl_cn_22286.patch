--- openssl/ssl/t1_lib.c
+++ openssl/ssl/t1_lib.c
@@ -544,7 +544,7 @@
 		}
		skip_ext:
 
-	if (TLS1_get_version(s) >= TLS1_2_VERSION)
+	if (TLS1_get_client_version(s) >= TLS1_2_VERSION)
 		{
		if ((size_t)(limit - ret) < sizeof(tls12_sigalgs) + 6)
 			return NULL; 
